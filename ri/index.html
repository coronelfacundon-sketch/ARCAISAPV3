<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ARCA – ISAP · Responsable Inscripto (Simulación)</title>
<style>
  :root{--pri:#0d5c63;--pri2:#157a85;--bg:#f4f7f8;--card:#fff;--txt:#122126;--ok:#1b7f5b;--warn:#b26a00;--err:#b00020;--muted:#5a6b70;--shadow:0 10px 30px rgba(0,0,0,.08)}
  *{box-sizing:border-box} body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--txt)}
  header{background:linear-gradient(135deg,var(--pri),var(--pri2));color:#fff;padding:24px 20px}
  .wrap{max-width:1100px;margin:0 auto;padding:18px} h1{margin:0;font-size:26px;font-weight:800} .sub{opacity:.9;margin-top:6px}
  .disc{background:#fff2;border-left:4px solid #fff7;padding:10px 12px;margin-top:10px;border-radius:10px;font-size:14px}
  nav .nav{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap} nav .nav a, nav .nav button{text-decoration:none;border:0;border-radius:10px;padding:8px 12px;background:#0d5c63;color:#fff;cursor:pointer;font-weight:700;display:inline-block}
  .card{background:var(--card);border-radius:18px;box-shadow:var(--shadow);padding:18px}
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
  .col-3{grid-column:span 3}.col-4{grid-column:span 4}.col-6{grid-column:span 6}.col-8{grid-column:span 8}.col-12{grid-column:span 12}
  label{font-weight:650;font-size:14px}
  input,select{width:100%;padding:12px 11px;margin-top:6px;border:1px solid #d4dee1;border-radius:12px;background:#fbfeff;outline:none;transition:box-shadow .2s,border-color .2s}
  input:focus,select:focus{border-color:var(--pri2);box-shadow:0 0 0 3px rgba(21,122,133,.15)}
  .actions{display:flex;gap:10px;justify-content:flex-end;margin-top:14px}
  button{border:0;border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer} .btn{background:var(--pri);color:#fff} .btn.secondary{background:#e7eef0;color:#1b3136} .btn.ghost{background:transparent;border:2px solid #c6d7db;color:#234}
  .tile{background:#fff;border:1px solid #e6eef1;border-radius:16px;padding:18px;box-shadow:var(--shadow)} .tile h3{margin:0 0 10px 0} .tile p{margin:6px 0 14px 0;color:#345} .tile a,.tile button{width:100%}
  .hint{font-size:12px;color:var(--muted);margin-top:6px}
  @media (max-width:780px){.col-8,.col-6,.col-4,.col-3{grid-column:span 12} }
  /* tablas empleados */
  table{width:100%;border-collapse:collapse} th,td{border:1px solid #e6eef1;padding:8px 10px;text-align:left;font-size:14px} th{background:#f3f8f9;font-weight:800}
  .badge{display:inline-block;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:800} .badge.ok{background:#e5f6ef;color:var(--ok)}
  .steps{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 16px} .step{flex:1 1 150px;background:#e8eff0;border-radius:12px;padding:8px 10px;display:flex;gap:10px;align-items:center} .step.active{background:#d1eef1;border:1px solid #9ad5db} .step .n{background:#0d5c63;color:#fff;border-radius:10px;padding:3px 8px;font-weight:800;min-width:26px;text-align:center}
  .errbox{font-size:12px;color:#fff;background:var(--err);padding:6px 8px;border-radius:10px;margin-top:8px;display:none} .errbox.show{display:inline-block}
  .tag{display:inline-block;padding:6px 10px;background:#eef5f6;border:1px solid #cfe1e4;border-radius:999px;margin:4px 6px 0 0;font-size:12px}
  .integrante{display:flex;gap:8px;margin-top:8px} .integrante input{flex:1}
  .const-card{padding:16px;background:#fff;border:1px solid #e3eef1;border-radius:12px}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>ARCA – Simulación Educativa</h1>
    <div class="sub">Responsable Inscripto — simulación (Buenos Aires o CABA)</div>
    <div class="disc">Uso pedagógico. No envía datos a servidores ni organismos. No usar datos reales.</div>
    <nav><div class="nav">
      <a href="../">Inicio</a>
      <a href="../monotributo/">Monotributista</a>
      <a href="../ri/">Responsable Inscripto</a>
      <a href="../empleados/">Empleados</a>
    </div></nav>
  </div>
</header>
<main class="wrap">

<section id="viewApp" class="card">
  <div id="steps" class="steps"></div>

  <!-- Paso 1: Identificación -->
  <section class="panel" data-step="0">
    <h2>1) Identificación</h2>
    <div class="grid">
      <div class="col-6"><label>Nombre</label><input id="r_nombre"></div>
      <div class="col-6"><label>Apellido</label><input id="r_apellido"></div>
      <div class="col-4"><label>Tipo de documento</label><select id="r_tipoDoc"><option>DNI</option><option>LE</option><option>LC</option></select></div>
      <div class="col-4"><label>Nº de documento (ficticio)</label><input id="r_nroDoc" maxlength="9" placeholder="7–9 dígitos"></div>
      <div class="col-4"><label>CUIT/CUIL (simulado)</label><input id="r_cuit" maxlength="11" placeholder="11 dígitos"></div>
      <div class="col-6"><label>Email</label><input id="r_email" placeholder="correo@colegio.com"></div>
      <div class="col-6"><label>Teléfono</label><input id="r_tel" type="text" inputmode="numeric" pattern="\d*" placeholder="Ej: 1123456789"></div>
    </div>
    <div class="errbox" data-for="r0"></div>
    <div class="actions"><a class="btn secondary" href="../">Cancelar</a><button class="btn" onclick="nextStep()">Continuar</button></div>
  </section>

  <!-- Paso 2: Domicilios -->
  <section class="panel" data-step="1" hidden>
    <h2>2) Domicilios</h2>
    <div class="grid">
      <div class="col-6"><label>Calle</label><input id="r_calle"></div>
      <div class="col-3"><label>Número</label><input id="r_numero"></div>
      <div class="col-3"><label>Piso / Dpto (opcional)</label><input id="r_piso"></div>
      <div class="col-5"><label>Localidad</label><input id="r_localidad"></div>
      <div class="col-4"><label>Provincia</label><select id="r_provincia"></select></div>
      <div class="col-3"><label>CP</label><input id="r_cp" maxlength="8" placeholder="BA: 4 dígitos · CABA: 4 dígitos o CPA"><div class="hint" id="r_cpHint">Seleccioná provincia para ver la regla de CP.</div></div>
    </div>
    <div class="errbox" data-for="r1"></div>
    <div class="actions"><button class="btn secondary" onclick="prevStep()">Atrás</button><button class="btn" onclick="nextStep()">Continuar</button></div>
  </section>

  <!-- Paso 3: Actividad & IVA/IIBB -->
  <section class="panel" data-step="2" hidden>
    <h2>3) Actividad e impuestos</h2>
    <div class="grid">
      <div class="col-6"><label>Actividad (simulada)</label><select id="r_actividad"></select></div>
      <div class="col-6"><label>Descripción (opcional)</label><input id="r_actDesc" placeholder="Breve descripción"></div>

      <div class="col-4"><label>Fecha de inicio de actividad</label><input id="r_fechaInicio" placeholder="dd/mm/aaaa o aaaa-mm-dd"></div>
      <div class="col-4"><label>Condición IVA</label><select id="r_condIVA"><option>Responsable Inscripto</option></select></div>
      <div class="col-4"><label>¿Con punto de venta?</label><select id="r_pventa"><option>No</option><option>Sí</option></select></div>

      <div class="col-4"><label>Condición IIBB</label><select id="r_condIIBB"><option>Local (única jurisdicción)</option><option>Convenio Multilateral</option></select></div>
      <div class="col-4"><label>Código IIBB (NAES/NAIIBB)</label><input id="r_codIIBB" placeholder="Ej: 471130"></div>
      <div class="col-4"><label>Fecha alta IIBB</label><input id="r_fechaIIBB" placeholder="dd/mm/aaaa o aaaa-mm-dd"></div>

      <div class="col-6" id="r_cmBox" hidden>
        <label>Jurisdicción principal (CM)</label>
        <select id="r_jurPrincipal"></select>
        <div class="hint">Elegí BA o CABA para sede CM.</div>
      </div>

      <div class="col-12">
        <label style="display:flex;gap:10px;align-items:flex-start"><input type="checkbox" id="r_dfe"> <span>Constituye Domicilio Fiscal Electrónico <b id="r_dfeLabel">(ARBA/AGIP)</b> y acepta notificaciones (simulado).</span></label>
      </div>
    </div>
    <div class="errbox" data-for="r2"></div>
    <div class="actions"><button class="btn secondary" onclick="prevStep()">Atrás</button><button class="btn" onclick="nextStep()">Revisar</button></div>
  </section>

  <!-- Paso 4: Revisión -->
  <section class="panel" data-step="3" hidden>
    <h2>4) Revisión y confirmación</h2>
    <div id="r_resumen" class="card" style="background:#f5fbfc;border:1px dashed #9ad5db"></div>
    <div class="actions"><button class="btn secondary" onclick="prevStep()">Atrás</button><button class="btn" onclick="confirmar()">Confirmar alta (simulada)</button></div>
  </section>

  <!-- Paso 5: Constancia -->
  <section class="panel" data-step="4" hidden>
    <h2>Constancia de alta – Simulación</h2>
    <div id="r_constancia" class="const-card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><b>ARCA – Simulación Educativa (ISAP)</b><div class="badge ok">Válida solo para prácticas escolares</div></div>
      <div id="r_const_datos"></div>
      <div class="hint" style="margin-top:10px">Código verificación (ficticio): <span id="r_codigo"></span></div>
    </div>
    <div class="actions"><button class="btn" onclick="window.print()">Imprimir / PDF</button><button class="btn secondary" onclick="exportExcel()">Descargar datos_RI.xls</button><a class="btn ghost" href="../">Volver al inicio</a></div>
  </section>
</section>

<script>
const PROVINCIAS=["Buenos Aires","CABA"];
const ACTIVIDADES=[{id:"471130",nombre:"Kiosco / Venta minorista general"},{id:"620100",nombre:"Desarrollo/soporte de software"},{id:"561020",nombre:"Gastronomía (takeaway)"},{id:"855300",nombre:"Docencia particular / cursos"},{id:"433010",nombre:"Carpintería / oficios"}];
const state=JSON.parse(localStorage.getItem('arca_ri_state_v1')||'{}');
const registros=JSON.parse(localStorage.getItem('arca_ri_regs_v1')||'[]');
const $=s=>document.querySelector(s); const $$=s=>Array.from(document.querySelectorAll(s));
function setErr(step,msg){const e=$('.errbox[data-for="r'+step+'"]'); if(!e) return; if(msg){e.textContent=msg; e.classList.add('show');} else {e.classList.remove('show');}}
function setInvalid(id,flag){const el=document.getElementById(id); if(!el) return; if(flag){el.classList.add('invalid')}else{el.classList.remove('invalid')}}
function getVal(id){return (document.getElementById(id)?.value||'').trim()} function setVal(id,val){const el=document.getElementById(id); if(el) el.value=val??''}
function saveState(){localStorage.setItem('arca_ri_state_v1',JSON.stringify(state))}
const TIT=["Identificación","Domicilios","Actividad e impuestos","Revisión","Constancia"];
function renderSteps(cur=0){const w=$('#steps'); w.innerHTML=''; TIT.forEach((t,i)=>{const d=document.createElement('div'); d.className='step'+(i===cur?' active':''); d.innerHTML='<div class="n">'+(i+1)+'</div><div>'+t+'</div>'; w.appendChild(d);});}
let step=0; function showStep(n){step=n; renderSteps(n); $$('.panel').forEach(p=>p.hidden=(parseInt(p.dataset.step)!==n)); window.scrollTo({top:0,behavior:'smooth'}); if(n===3) resumen(); if(n===4) constancia();}
(function init(){ const p=$('#r_provincia'), jp=$('#r_jurPrincipal'); PROVINCIAS.forEach(x=>{const o=document.createElement('option'); o.textContent=x; p.appendChild(o.cloneNode(true)); jp.appendChild(o.cloneNode(true));}); const a=$('#r_actividad'); ACTIVIDADES.forEach(A=>{const o=document.createElement('option'); o.value=A.id; o.textContent=A.id+' — '+A.nombre; a.appendChild(o);}); })();
function updateHints(){ const p=getVal('r_provincia'); const isBA=(p==='Buenos Aires'); $('#r_cpHint').textContent = isBA?'CP BA: 4 dígitos.':'CP CABA: 4 dígitos o CPA (ej. 1000ABC o C1000ABC).'; $('#r_dfeLabel').textContent = isBA?'(ARBA)':'(AGIP)'; }
document.getElementById('r_provincia').addEventListener('change', updateHints);
document.getElementById('r_condIIBB').addEventListener('change',()=>{$('#r_cmBox').hidden = (getVal('r_condIIBB')!=='Convenio Multilateral')?true:false;});
const digits=v=>(v||'').replace(/\D/g,''); const emailNorm=v=>(v||'').toLowerCase().replace(/\s+/g,'');
document.addEventListener('input',e=>{ const id=e.target?.id; if(['r_tel','r_nroDoc','r_cuit','r_numero'].includes(id)) e.target.value=digits(e.target.value); if(id==='r_email') e.target.value=emailNorm(e.target.value); if(id==='r_cp') e.target.value=e.target.value.toUpperCase().replace(/[^0-9A-Z]/g,''); });
function parseDate(s){ if(!s) return null; const m1=s.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})$/); if(m1){const d=new Date(+m1[3],+m1[2]-1,+m1[1]); return isNaN(d)?null:d;} const m2=s.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})$/); if(m2){const d=new Date(+m2[1],+m2[2]-1,+m2[3]); return isNaN(d)?null:d;} const d=new Date(s); return isNaN(d)?null:d; }
function cpValido(v,prov){ if(prov==='Buenos Aires') return /^\d{4}$/.test(v); return /^\d{4}([A-Za-z]{3})?$/.test(v) || /^[A-Z]\d{4}[A-Z]{3}$/.test(v); }
function validate(n){ let ok=true; setErr(n,''); if(n===0){ const campos=[['r_nombre',v=>!!v,'Ingresá nombre'],['r_apellido',v=>!!v,'Ingresá apellido'],['r_nroDoc',v=>/^\d{7,9}$/.test(v),'DNI 7–9 dígitos'],['r_cuit',v=>!v||/^\d{11}$/.test(v),'CUIT/CUIL: 11 dígitos (opcional)'],['r_email',v=>/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(emailNorm(v)),'Correo no válido'],['r_tel',v=>{const c=digits(v).length;return c>=6&&c<=15},'Teléfono 6–15 dígitos']]; for(const [id,fn,msg] of campos){const v=getVal(id); const okf=fn(v); setInvalid(id,!okf); if(!okf&&ok){ok=false; setErr(0,msg); document.getElementById(id).focus();}} if(ok){Object.assign(state,{r_nombre:getVal('r_nombre'),r_apellido:getVal('r_apellido'),r_tipoDoc:getVal('r_tipoDoc'),r_nroDoc:getVal('r_nroDoc'),r_cuit:getVal('r_cuit'),r_email:emailNorm(getVal('r_email')),r_tel:getVal('r_tel')}); saveState();} }
  if(n===1){ const campos=[['r_calle',v=>!!v,'Ingresá calle'],['r_numero',v=>/^\d{1,6}$/.test(v),'Número inválido'],['r_localidad',v=>!!v,'Ingresá localidad'],['r_provincia',v=>!!v,'Seleccioná provincia'],['r_cp',v=>cpValido(v,getVal('r_provincia')),'CP inválido']]; for(const [id,fn,msg] of campos){const v=getVal(id); const okf=fn(v); setInvalid(id,!okf); if(!okf&&ok){ok=false; setErr(1,msg); document.getElementById(id).focus();}} if(ok){Object.assign(state,{r_calle:getVal('r_calle'),r_numero:getVal('r_numero'),r_piso:getVal('r_piso'),r_localidad:getVal('r_localidad'),r_provincia:getVal('r_provincia'),r_cp:getVal('r_cp')}); saveState(); updateHints();} }
  if(n===2){ const campos=[['r_actividad',v=>!!v,'Seleccioná actividad'],['r_fechaInicio',v=>!!parseDate(v),'Fecha de inicio inválida'],['r_codIIBB',v=>!!v,'Código IIBB requerido'],['r_fechaIIBB',v=>!!parseDate(v),'Fecha alta IIBB inválida']]; for(const [id,fn,msg] of campos){const v=getVal(id); const okf=fn(v); setInvalid(id,!okf); if(!okf&&ok){ok=false; setErr(2,msg); document.getElementById(id).focus();}} if(ok && getVal('r_condIIBB')==='Convenio Multilateral' && !getVal('r_jurPrincipal')){ ok=false; setErr(2,'Seleccioná jurisdicción principal para CM.'); } if(ok){Object.assign(state,{r_actividad:getVal('r_actividad'),r_actDesc:getVal('r_actDesc'),r_fechaInicio:getVal('r_fechaInicio'),r_condIVA:getVal('r_condIVA'),r_pventa:getVal('r_pventa'),r_condIIBB:getVal('r_condIIBB'),r_codIIBB:getVal('r_codIIBB'),r_fechaIIBB:getVal('r_fechaIIBB'),r_jurPrincipal:getVal('r_jurPrincipal'),r_dfe:document.getElementById('r_dfe').checked}); saveState();} }
  return ok; }
function nextStep(){ if(validate(step)) showStep(step+1); } function prevStep(){ showStep(Math.max(0,step-1)); }
function resumen(){ const ag=(state.r_provincia==='Buenos Aires'?'ARBA':(state.r_provincia==='CABA'?'AGIP':'ARBA/AGIP')); $('#r_resumen').innerHTML=`
  <div class="grid">
    <div class="col-6"><b>Contribuyente</b><br>${state.r_apellido||''}, ${state.r_nombre||''} — ${state.r_tipoDoc||''} ${state.r_nroDoc||''} ${state.r_cuit?('— CUIT/CUIL '+state.r_cuit):''}</div>
    <div class="col-6"><b>Contacto</b><br>${state.r_email||''} · ${state.r_tel||''}</div>
    <div class="col-6"><b>Domicilio fiscal</b><br>${state.r_calle||''} ${state.r_numero||''} ${state.r_piso?('('+state.r_piso+')'):''}, ${state.r_localidad||''}, ${state.r_provincia||''} (${state.r_cp||''})</div>
    <div class="col-12"><b>Actividad/Impuestos</b><br>${state.r_actividad||''} — ${state.r_actDesc||''} | Inicio: ${state.r_fechaInicio||''} | IVA: ${state.r_condIVA||''} | IIBB ${ag}: ${state.r_condIIBB||''} ${state.r_jurPrincipal?('('+state.r_jurPrincipal+')'):''} | Cód: ${state.r_codIIBB||''} | Alta IIBB: ${state.r_fechaIIBB||''} | DFE: ${state.r_dfe?'Sí':'No'}</div>
  </div>`; }
function constancia(){ const ag=(state.r_provincia==='Buenos Aires'?'ARBA':(state.r_provincia==='CABA'?'AGIP':'ARBA/AGIP')); $('#r_const_datos').innerHTML = `
  <div style="line-height:1.7">
    <b>Contribuyente:</b> ${state.r_apellido||''}, ${state.r_nombre||''} — ${state.r_tipoDoc||''} ${state.r_nroDoc||''} ${state.r_cuit?('— CUIT/CUIL '+state.r_cuit):''}<br>
    <b>Contacto:</b> ${state.r_email||''} / ${state.r_tel||''}<br>
    <b>Domicilio fiscal:</b> ${state.r_calle||''} ${state.r_numero||''} ${state.r_piso?('('+state.r_piso+')'):''}, ${state.r_localidad||''}, ${state.r_provincia||''} (${state.r_cp||''})<br>
    <b>Actividad/Impuestos:</b> ${state.r_actividad||''} — ${state.r_actDesc||''} — <b>Inicio:</b> ${state.r_fechaInicio||''} — IVA: ${state.r_condIVA||''} — IIBB ${ag}: ${state.r_condIIBB||''} ${state.r_jurPrincipal?('('+state.r_jurPrincipal+')'):''} — Cód: ${state.r_codIIBB||''} — Alta IIBB: ${state.r_fechaIIBB||''} — DFE: ${state.r_dfe?'Sí':'No'}<br>
    <b>Régimen:</b> Responsable Inscripto (simulado)<br>
    <b>Fecha (simulada):</b> ${new Date().toLocaleString('es-AR')}
  </div>`; $('#r_codigo').textContent = state.r_codigo||'-'; }
const HEAD=["fechaRegistro","apellido","nombre","tipoDoc","nroDoc","cuit","email","tel","calle","numero","piso","localidad","provincia","cp","actividad","actDesc","fechaInicio","condIVA","pventa","condIIBB","codIIBB","fechaIIBB","jurPrincipal","dfe","codigo"];
function htmlExcel(){ const esc=s=>String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); const rows=registros.map(r=>'<tr>'+HEAD.map(k=>`<td>${esc(r[k]??'')}</td>`).join('')+'</tr>').join(''); const head=HEAD.map(h=>`<th>${h}</th>`).join(''); return `<!DOCTYPE html><html><head><meta charset="UTF-8"></head><body><table border="1"><thead><tr>${head}</tr></thead><tbody>${rows}</tbody></table></body></html>`; }
function exportExcel(){ const blob=new Blob([htmlExcel()],{type:'application/vnd.ms-excel'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='datos_RI.xls'; a.click(); URL.revokeObjectURL(url); }
function nextStep(){ if(validate(step)) showStep(step+1); }
function prevStep(){ showStep(Math.max(0,step-1)); }
function registrarYMostrar(){ const id='RI'+Math.random().toString(36).slice(2,8).toUpperCase()+Date.now().toString().slice(-4); state.r_codigo=id; localStorage.setItem('arca_ri_state_v1',JSON.stringify(state));
  const reg={ fechaRegistro:new Date().toISOString(), apellido:state.r_apellido||'', nombre:state.r_nombre||'', tipoDoc:state.r_tipoDoc||'', nroDoc:state.r_nroDoc||'', cuit:state.r_cuit||'', email:state.r_email||'', tel:state.r_tel||'', calle:state.r_calle||'', numero:state.r_numero||'', piso:state.r_piso||'', localidad:state.r_localidad||'', provincia:state.r_provincia||'', cp:state.r_cp||'', actividad:state.r_actividad||'', actDesc:state.r_actDesc||'', fechaInicio:state.r_fechaInicio||'', condIVA:state.r_condIVA||'', pventa:state.r_pventa||'', condIIBB:state.r_condIIBB||'', codIIBB:state.r_codIIBB||'', fechaIIBB:state.r_fechaIIBB||'', jurPrincipal:state.r_jurPrincipal||'', dfe:state.r_dfe?'Sí':'No', codigo:id };
  registros.push(reg); localStorage.setItem('arca_ri_regs_v1',JSON.stringify(registros)); constancia(); showStep(4); }
function confirmar(){ if(!validate(2)) return; resumen(); registrarYMostrar(); }
renderSteps(0); showStep(0);
</script>
</main>
</body>
</html>
